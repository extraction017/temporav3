# Tempora - Data Flow Diagram

## Overview
This document illustrates how data flows through the Tempora system when users interact with the UI. It covers all major user actions and their corresponding data transformations.

---

## 1. Application Initialization

### Flow: User Opens Application
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER OPENS TEMPORA                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND (React Component Mount)                        â”‚
â”‚                                                          â”‚
â”‚ 1. App.jsx renders                                      â”‚
â”‚    â”œâ”€â”€ Header (logo, clock, weather)                    â”‚
â”‚    â””â”€â”€ Calendar.jsx                                     â”‚
â”‚                                                          â”‚
â”‚ 2. useEffect() hook triggers                            â”‚
â”‚    â”œâ”€â”€ fetchEvents()                                    â”‚
â”‚    â””â”€â”€ fetchPreferences()                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUESTS (Axios)                                   â”‚
â”‚                                                          â”‚
â”‚ GET /events                                             â”‚
â”‚ GET /preferences                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (Flask API - app.py)                            â”‚
â”‚                                                          â”‚
â”‚ @app.route("/events", methods=["GET"])                  â”‚
â”‚   â”œâ”€â”€ db.get_all_events()                               â”‚
â”‚   â””â”€â”€ return jsonify(events)                            â”‚
â”‚                                                          â”‚
â”‚ @app.route("/preferences", methods=["GET"])             â”‚
â”‚   â”œâ”€â”€ db.get_user_preferences()                         â”‚
â”‚   â””â”€â”€ return jsonify(preferences)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE (SQLite - database.py)                         â”‚
â”‚                                                          â”‚
â”‚ get_all_events():                                       â”‚
â”‚   SELECT * FROM events ORDER BY start_time              â”‚
â”‚                                                          â”‚
â”‚ get_user_preferences():                                 â”‚
â”‚   SELECT * FROM user_preferences WHERE id = 1           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼ (JSON Response)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND STATE UPDATE                                   â”‚
â”‚                                                          â”‚
â”‚ setEvents([...])      // Update events state            â”‚
â”‚ setPreferences({...}) // Update preferences state       â”‚
â”‚                                                          â”‚
â”‚ FullCalendar renders events on calendar grid            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. Creating a Fixed Event

### Flow: User Creates Fixed Event (e.g., Doctor Appointment)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION                                             â”‚
â”‚                                                          â”‚
â”‚ 1. User clicks "Add Fixed Event" button                â”‚
â”‚ 2. Modal form opens                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND (Calendar.jsx)                                 â”‚
â”‚                                                          â”‚
â”‚ setActiveForm('fixed')  // Show fixed event form        â”‚
â”‚                                                          â”‚
â”‚ User fills form:                                        â”‚
â”‚   â”œâ”€â”€ Title: "Doctor Appointment"                      â”‚
â”‚   â”œâ”€â”€ Start: 2024-10-25T14:00                          â”‚
â”‚   â”œâ”€â”€ End: 2024-10-25T15:00                            â”‚
â”‚   â”œâ”€â”€ Category: Personal                                â”‚
â”‚   â”œâ”€â”€ Priority: High                                    â”‚
â”‚   â””â”€â”€ Notes: "Annual checkup"                          â”‚
â”‚                                                          â”‚
â”‚ User clicks "Create Event"                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND VALIDATION                                     â”‚
â”‚                                                          â”‚
â”‚ handleSubmit():                                         â”‚
â”‚   â”œâ”€â”€ Check: end > start? âœ“                            â”‚
â”‚   â”œâ”€â”€ Check: title not empty? âœ“                        â”‚
â”‚   â”œâ”€â”€ Format: Round times to preference interval       â”‚
â”‚   â””â”€â”€ Build event object                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUEST                                            â”‚
â”‚                                                          â”‚
â”‚ POST /events                                            â”‚
â”‚ Body: {                                                 â”‚
â”‚   type: "event",                                        â”‚
â”‚   title: "Doctor Appointment",                         â”‚
â”‚   start: "2024-10-25T14:00:00",                        â”‚
â”‚   end: "2024-10-25T15:00:00",                          â”‚
â”‚   category: "Personal",                                 â”‚
â”‚   priority: "high",                                     â”‚
â”‚   notes: "Annual checkup"                              â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (app.py)                                        â”‚
â”‚                                                          â”‚
â”‚ @app.route("/events", methods=["POST"])                 â”‚
â”‚                                                          â”‚
â”‚ 1. parse_datetime(start, end)                          â”‚
â”‚ 2. round_to_interval(times, preferences)               â”‚
â”‚ 3. Check conflicts:                                     â”‚
â”‚    db.check_conflicts(start, end)                       â”‚
â”‚ 4. Check sleep intrusion:                              â”‚
â”‚    is_during_sleep(start, preferences)                  â”‚
â”‚ 5. Insert event:                                        â”‚
â”‚    event_id = db.insert_event(data)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE (database.py)                                  â”‚
â”‚                                                          â”‚
â”‚ insert_event(event_data):                               â”‚
â”‚                                                          â”‚
â”‚   INSERT INTO events (                                  â”‚
â”‚     type, title, start_time, end_time,                 â”‚
â”‚     category, priority, notes, locked                   â”‚
â”‚   ) VALUES (?, ?, ?, ?, ?, ?, ?, ?)                    â”‚
â”‚                                                          â”‚
â”‚   RETURN lastrowid  // Auto-increment ID                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼ (Success Response)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND RESPONSE                                        â”‚
â”‚                                                          â”‚
â”‚ return jsonify({                                        â”‚
â”‚   "message": "Event created",                          â”‚
â”‚   "event": {                                            â”‚
â”‚     id: 123,                                            â”‚
â”‚     title: "Doctor Appointment",                       â”‚
â”‚     start: "2024-10-25T14:00:00",                      â”‚
â”‚     ...                                                 â”‚
â”‚   }                                                     â”‚
â”‚ }), 201                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND STATE UPDATE                                   â”‚
â”‚                                                          â”‚
â”‚ 1. Add new event to events array:                      â”‚
â”‚    setEvents([...events, newEvent])                     â”‚
â”‚                                                          â”‚
â”‚ 2. Close modal form:                                    â”‚
â”‚    setActiveForm(null)                                  â”‚
â”‚                                                          â”‚
â”‚ 3. Reset form data:                                     â”‚
â”‚    setFormData(initialState)                            â”‚
â”‚                                                          â”‚
â”‚ 4. Show success message:                                â”‚
â”‚    alert("âœ… Event created!")                           â”‚
â”‚                                                          â”‚
â”‚ 5. FullCalendar re-renders with new event              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Creating a Floating Event

### Flow: User Creates Floating Event (e.g., Task)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION                                             â”‚
â”‚                                                          â”‚
â”‚ User clicks "Add Floating Event"                        â”‚
â”‚ User fills:                                             â”‚
â”‚   â”œâ”€â”€ Title: "Write report"                            â”‚
â”‚   â”œâ”€â”€ Duration: 2 hours                                 â”‚
â”‚   â”œâ”€â”€ Earliest Start: 2024-10-25T09:00                â”‚
â”‚   â”œâ”€â”€ Deadline: 2024-10-27T17:00                       â”‚
â”‚   â”œâ”€â”€ Preferred Time: 14:00 - 16:00 (optional)        â”‚
â”‚   â””â”€â”€ Priority: Medium                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUEST                                            â”‚
â”‚                                                          â”‚
â”‚ POST /events                                            â”‚
â”‚ Body: {                                                 â”‚
â”‚   type: "floating",                                     â”‚
â”‚   title: "Write report",                               â”‚
â”‚   duration: "2:00",                                     â”‚
â”‚   earliest_start: "2024-10-25T09:00:00",               â”‚
â”‚   deadline: "2024-10-27T17:00:00",                     â”‚
â”‚   preferred_time: "14:00 - 16:00",                     â”‚
â”‚   category: "Work",                                     â”‚
â”‚   priority: "medium"                                    â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (app.py) - create_event()                      â”‚
â”‚                                                          â”‚
â”‚ 1. Parse duration: 2 hours = 120 minutes               â”‚
â”‚ 2. Parse date range: Oct 25 09:00 â†’ Oct 27 17:00      â”‚
â”‚ 3. Parse preferred time: 14:00-16:00                   â”‚
â”‚                                                          â”‚
â”‚ 4. PROGRESSIVE FALLBACK SEARCH:                        â”‚
â”‚                                                          â”‚
â”‚    Phase 1: Search in preferred time window            â”‚
â”‚    â”œâ”€â”€ Loop through each day in range                  â”‚
â”‚    â”œâ”€â”€ Try 14:00-16:00 slot                            â”‚
â”‚    â””â”€â”€ Check conflicts                                  â”‚
â”‚                                                          â”‚
â”‚    IF slot_found:                                       â”‚
â”‚      RETURN slot                                        â”‚
â”‚                                                          â”‚
â”‚    Phase 2: Expand to Â±1 hour (13:00-17:00)           â”‚
â”‚    â”œâ”€â”€ Try wider window                                 â”‚
â”‚    â””â”€â”€ Check conflicts                                  â”‚
â”‚                                                          â”‚
â”‚    Phase 3: Try work hours (09:00-18:00)               â”‚
â”‚    Phase 4: Try any available slot (full day)          â”‚
â”‚                                                          â”‚
â”‚ 5. best_slot = first available slot found               â”‚
â”‚ 6. Create event at best_slot                           â”‚
â”‚ 7. db.insert_event(event)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼ (Response with scheduled time)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESPONSE                                                â”‚
â”‚                                                          â”‚
â”‚ {                                                        â”‚
â”‚   "message": "Floating event scheduled",               â”‚
â”‚   "event": {                                            â”‚
â”‚     id: 124,                                            â”‚
â”‚     title: "Write report",                             â”‚
â”‚     start: "2024-10-25T14:30:00",  // Auto-scheduled   â”‚
â”‚     end: "2024-10-25T16:30:00",                        â”‚
â”‚     type: "floating"                                    â”‚
â”‚   }                                                     â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND UPDATE                                         â”‚
â”‚                                                          â”‚
â”‚ Calendar displays event at auto-scheduled time          â”‚
â”‚ User sees: "Write report" on Oct 25 at 14:30           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. Viewing Health Score

### Flow: User Clicks "Health Score" Button
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION                                             â”‚
â”‚                                                          â”‚
â”‚ User clicks "ğŸ“Š Health Score" button                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND (Calendar.jsx)                                 â”‚
â”‚                                                          â”‚
â”‚ setHealthScoreOpen(true)  // Show modal                 â”‚
â”‚                                                          â”‚
â”‚ HealthScore component mounts                            â”‚
â”‚   â””â”€â”€ useEffect() triggers                              â”‚
â”‚       â””â”€â”€ fetchHealthScore(week_offset = 0)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUEST                                            â”‚
â”‚                                                          â”‚
â”‚ GET /health-score?week_offset=0                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (app.py)                                        â”‚
â”‚                                                          â”‚
â”‚ @app.route("/health-score", methods=["GET"])            â”‚
â”‚                                                          â”‚
â”‚ 1. Parse week_offset: 0 (current week)                 â”‚
â”‚ 2. Calculate date range:                                â”‚
â”‚    â”œâ”€â”€ Today = 2024-10-25 (Friday)                     â”‚
â”‚    â”œâ”€â”€ Monday = 2024-10-21                              â”‚
â”‚    â””â”€â”€ Sunday = 2024-10-27                              â”‚
â”‚                                                          â”‚
â”‚ 3. Fetch data:                                          â”‚
â”‚    events = db.get_events_in_range(                     â”‚
â”‚      "2024-10-21T00:00:00",                            â”‚
â”‚      "2024-10-27T23:59:59"                             â”‚
â”‚    )                                                    â”‚
â”‚    preferences = db.get_user_preferences()              â”‚
â”‚                                                          â”‚
â”‚ 4. Calculate score:                                     â”‚
â”‚    calculator = HealthScoreCalculator(events, prefs)    â”‚
â”‚    result = calculator.calculate_score()                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HEALTH SCORE CALCULATION (health_score.py)              â”‚
â”‚                                                          â”‚
â”‚ calculate_score():                                      â”‚
â”‚                                                          â”‚
â”‚ 1. Categorize events:                                   â”‚
â”‚    â”œâ”€â”€ work_events = filter(category = "Work")         â”‚
â”‚    â”œâ”€â”€ meetings = filter(category = "Meeting")         â”‚
â”‚    â”œâ”€â”€ recreational = filter(category = "Recreational")â”‚
â”‚    â””â”€â”€ meals = filter(category = "Meal")               â”‚
â”‚                                                          â”‚
â”‚ 2. Calculate 5 metrics:                                 â”‚
â”‚    â”œâ”€â”€ work_life_score = 85 (45 work hrs/week)         â”‚
â”‚    â”œâ”€â”€ sleep_score = 100 (no intrusions)               â”‚
â”‚    â”œâ”€â”€ focus_score = 70 (3 deep work blocks)           â”‚
â”‚    â”œâ”€â”€ meeting_score = 60 (3 back-to-back)             â”‚
â”‚    â””â”€â”€ recovery_score = 90 (12 hrs recreation)         â”‚
â”‚                                                          â”‚
â”‚ 3. Weighted composite:                                  â”‚
â”‚    score = (85*0.25 + 100*0.20 + 70*0.20 +             â”‚
â”‚            60*0.15 + 90*0.20) = 81                     â”‚
â”‚                                                          â”‚
â”‚ 4. Generate insights:                                   â”‚
â”‚    issues = ["3 back-to-back meetings detected"]       â”‚
â”‚    suggestions = ["Add 15-min buffers between mtgs"]   â”‚
â”‚                                                          â”‚
â”‚ 5. Return result object                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼ (JSON Response)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESPONSE                                                â”‚
â”‚                                                          â”‚
â”‚ {                                                        â”‚
â”‚   score: 81,                                            â”‚
â”‚   breakdown: {                                          â”‚
â”‚     work_life: 85,                                      â”‚
â”‚     sleep_respect: 100,                                 â”‚
â”‚     focus_blocks: 70,                                   â”‚
â”‚     meetings: 60,                                       â”‚
â”‚     recovery: 90                                        â”‚
â”‚   },                                                    â”‚
â”‚   issues: ["âš ï¸ 3 back-to-back meetings"],              â”‚
â”‚   suggestions: ["ğŸ’¡ Add 15-min buffers"],              â”‚
â”‚   weekly_stats: {                                       â”‚
â”‚     work_hours: 45,                                     â”‚
â”‚     meeting_hours: 12,                                  â”‚
â”‚     recovery_hours: 12,                                 â”‚
â”‚     focus_time: 15                                      â”‚
â”‚   }                                                     â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND VISUALIZATION (HealthScore.jsx)                â”‚
â”‚                                                          â”‚
â”‚ 1. Display overall score:                               â”‚
â”‚    ğŸ¯ Health Score: 81/100                             â”‚
â”‚                                                          â”‚
â”‚ 2. Render breakdown chart (Chart.js):                   â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚    â”‚ Work/Life: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 85  â”‚                         â”‚
â”‚    â”‚ Sleep:     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 100â”‚                         â”‚
â”‚    â”‚ Focus:     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 70    â”‚                         â”‚
â”‚    â”‚ Meetings:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 60     â”‚                         â”‚
â”‚    â”‚ Recovery:  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 90  â”‚                         â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                          â”‚
â”‚ 3. List issues & suggestions:                           â”‚
â”‚    âš ï¸ 3 back-to-back meetings                          â”‚
â”‚    ğŸ’¡ Add 15-min buffers between meetings              â”‚
â”‚                                                          â”‚
â”‚ 4. Show weekly stats table                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. Applying Schedule Optimization

### Flow: User Clicks "Balance Schedule" Button
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION                                             â”‚
â”‚                                                          â”‚
â”‚ User clicks "âš–ï¸ Balance Schedule" optimization         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUEST                                            â”‚
â”‚                                                          â”‚
â”‚ POST /apply-optimization                                â”‚
â”‚ Body: {                                                 â”‚
â”‚   action: "consolidate_schedule",                      â”‚
â”‚   week_offset: 0                                        â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (app.py)                                        â”‚
â”‚                                                          â”‚
â”‚ @app.route("/apply-optimization", methods=["POST"])     â”‚
â”‚                                                          â”‚
â”‚ 1. Get current week's events                           â”‚
â”‚ 2. Get user preferences                                 â”‚
â”‚ 3. Create OptimizationEngine                           â”‚
â”‚ 4. Call optimization method:                            â”‚
â”‚    result = engine.smart_optimize_week()                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OPTIMIZATION ENGINE (optimizations.py)                  â”‚
â”‚                                                          â”‚
â”‚ smart_optimize_week():                                  â”‚
â”‚                                                          â”‚
â”‚ CURRENT SCHEDULE (unbalanced):                          â”‚
â”‚ Monday:    8 hours (5 events)                           â”‚
â”‚ Tuesday:   2 hours (1 event)                            â”‚
â”‚ Wednesday: 7 hours (4 events)                           â”‚
â”‚ Thursday:  1 hour  (1 event)                            â”‚
â”‚ Friday:    6 hours (3 events)                           â”‚
â”‚                                                          â”‚
â”‚ ALGORITHM:                                              â”‚
â”‚                                                          â”‚
â”‚ 1. Separate events:                                     â”‚
â”‚    locked_events = [past events, manually locked]       â”‚
â”‚    moveable_events = [future unlocked events]          â”‚
â”‚                                                          â”‚
â”‚ 2. Initialize simulation with locked events             â”‚
â”‚                                                          â”‚
â”‚ 3. For each moveable event:                             â”‚
â”‚    a) Calculate TOTAL DURATION on each day              â”‚
â”‚    b) Choose day with LEAST duration                    â”‚
â”‚    c) Find best slot on that day using:                 â”‚
â”‚       - Progressive fallback                            â”‚
â”‚       - Multi-criteria scoring                          â”‚
â”‚    d) Add to simulation                                 â”‚
â”‚                                                          â”‚
â”‚ RESULT (balanced):                                      â”‚
â”‚ Monday:    5 hours (3 events)                           â”‚
â”‚ Tuesday:   5 hours (3 events)                           â”‚
â”‚ Wednesday: 4 hours (2 events)                           â”‚
â”‚ Thursday:  5 hours (3 events)                           â”‚
â”‚ Friday:    5 hours (3 events)                           â”‚
â”‚                                                          â”‚
â”‚ modifications = [                                       â”‚
â”‚   {event_id: 123, old_start: Mon 14:00,                â”‚
â”‚    new_start: Tue 10:00},                              â”‚
â”‚   {event_id: 124, old_start: Mon 16:00,                â”‚
â”‚    new_start: Thu 14:00},                              â”‚
â”‚   ...                                                   â”‚
â”‚ ]                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼ (Preview Response)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESPONSE                                                â”‚
â”‚                                                          â”‚
â”‚ {                                                        â”‚
â”‚   "action": "consolidate_schedule",                    â”‚
â”‚   "modifications": [                                    â”‚
â”‚     {                                                   â”‚
â”‚       event_id: 123,                                    â”‚
â”‚       event_title: "Write report",                     â”‚
â”‚       old_start: "2024-10-21T14:00:00",                â”‚
â”‚       new_start: "2024-10-22T10:00:00",                â”‚
â”‚       reason: "Workload balancing"                     â”‚
â”‚     },                                                  â”‚
â”‚     ...                                                 â”‚
â”‚   ],                                                    â”‚
â”‚   "preview_score": {                                    â”‚
â”‚     before: 81,                                         â”‚
â”‚     after: 87,                                          â”‚
â”‚     improvement: +6                                     â”‚
â”‚   },                                                    â”‚
â”‚   "message": "5 events rescheduled for balance"        â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND (Calendar.jsx)                                 â”‚
â”‚                                                          â”‚
â”‚ 1. Show preview modal:                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚    â”‚ Optimization Preview             â”‚                â”‚
â”‚    â”‚                                  â”‚                â”‚
â”‚    â”‚ Changes (5 events):              â”‚                â”‚
â”‚    â”‚ â€¢ Write report:                  â”‚                â”‚
â”‚    â”‚   Mon 14:00 â†’ Tue 10:00          â”‚                â”‚
â”‚    â”‚ â€¢ Team meeting:                  â”‚                â”‚
â”‚    â”‚   Mon 16:00 â†’ Thu 14:00          â”‚                â”‚
â”‚    â”‚                                  â”‚                â”‚
â”‚    â”‚ Predicted improvement:           â”‚                â”‚
â”‚    â”‚ Health: 81 â†’ 87 (+6)            â”‚                â”‚
â”‚    â”‚                                  â”‚                â”‚
â”‚    â”‚ [Apply] [Cancel]                 â”‚                â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                          â”‚
â”‚ 2. User clicks "Apply"                                  â”‚
â”‚                                                          â”‚
â”‚ 3. Batch update events:                                 â”‚
â”‚    FOR EACH modification:                               â”‚
â”‚      PUT /events/{event_id}                             â”‚
â”‚      Body: {start: new_start, end: new_end}             â”‚
â”‚                                                          â”‚
â”‚ 4. Refresh calendar:                                    â”‚
â”‚    fetchEvents()                                        â”‚
â”‚                                                          â”‚
â”‚ 5. Show success:                                        â”‚
â”‚    "âœ… Schedule optimized! 5 events moved."            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 6. Editing an Event

### Flow: User Right-Clicks Event and Selects "Edit"
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION                                             â”‚
â”‚                                                          â”‚
â”‚ 1. User right-clicks event on calendar                 â”‚
â”‚ 2. Context menu appears                                 â”‚
â”‚ 3. User clicks "âœï¸ Edit"                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND (Calendar.jsx)                                 â”‚
â”‚                                                          â”‚
â”‚ handleContextMenuAction('edit', event):                 â”‚
â”‚                                                          â”‚
â”‚ 1. Set editing state:                                   â”‚
â”‚    setEditingEvent(event)                               â”‚
â”‚                                                          â”‚
â”‚ 2. Populate form with event data:                       â”‚
â”‚    setFormData({                                        â”‚
â”‚      title: event.title,                               â”‚
â”‚      start: event.start,                               â”‚
â”‚      end: event.end,                                    â”‚
â”‚      category: event.category,                          â”‚
â”‚      priority: event.priority,                          â”‚
â”‚      notes: event.notes                                 â”‚
â”‚    })                                                   â”‚
â”‚                                                          â”‚
â”‚ 3. Open appropriate form:                               â”‚
â”‚    setActiveForm(event.type)  // 'fixed', 'recurring'  â”‚
â”‚                                                          â”‚
â”‚ 4. User modifies fields                                 â”‚
â”‚ 5. User clicks "Save Changes"                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUEST                                            â”‚
â”‚                                                          â”‚
â”‚ PUT /events/123                                         â”‚
â”‚ Body: {                                                 â”‚
â”‚   title: "Doctor Appointment (Updated)",               â”‚
â”‚   start: "2024-10-25T15:00:00",  // Time changed       â”‚
â”‚   end: "2024-10-25T16:00:00",                          â”‚
â”‚   notes: "Annual checkup + flu shot"                   â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (app.py)                                        â”‚
â”‚                                                          â”‚
â”‚ @app.route("/events/<int:event_id>", methods=["PUT"])  â”‚
â”‚                                                          â”‚
â”‚ 1. Fetch existing event:                                â”‚
â”‚    event = db.get_event_by_id(123)                      â”‚
â”‚                                                          â”‚
â”‚ 2. Validate changes:                                    â”‚
â”‚    IF time changed:                                     â”‚
â”‚      conflicts = db.check_conflicts(                    â”‚
â”‚        new_start, new_end,                             â”‚
â”‚        exclude_id=123  // Don't check against self     â”‚
â”‚      )                                                  â”‚
â”‚      IF conflicts:                                      â”‚
â”‚        RETURN 409 Conflict                             â”‚
â”‚                                                          â”‚
â”‚ 3. Update database:                                     â”‚
â”‚    db.update_event(123, {                              â”‚
â”‚      title: "Doctor Appointment (Updated)",            â”‚
â”‚      start_time: "2024-10-25T15:00:00",                â”‚
â”‚      end_time: "2024-10-25T16:00:00",                  â”‚
â”‚      notes: "Annual checkup + flu shot"                â”‚
â”‚    })                                                   â”‚
â”‚                                                          â”‚
â”‚ 4. Return updated event                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE (database.py)                                  â”‚
â”‚                                                          â”‚
â”‚ update_event(event_id, updates):                        â”‚
â”‚                                                          â”‚
â”‚   UPDATE events                                         â”‚
â”‚   SET title = ?,                                        â”‚
â”‚       start_time = ?,                                   â”‚
â”‚       end_time = ?,                                     â”‚
â”‚       notes = ?                                         â”‚
â”‚   WHERE id = 123                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼ (Success Response)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESPONSE                                                â”‚
â”‚                                                          â”‚
â”‚ {                                                        â”‚
â”‚   "message": "Event updated successfully",             â”‚
â”‚   "event": {                                            â”‚
â”‚     id: 123,                                            â”‚
â”‚     title: "Doctor Appointment (Updated)",             â”‚
â”‚     start: "2024-10-25T15:00:00",                      â”‚
â”‚     end: "2024-10-25T16:00:00",                        â”‚
â”‚     ...                                                 â”‚
â”‚   }                                                     â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND STATE UPDATE                                   â”‚
â”‚                                                          â”‚
â”‚ 1. Update event in state:                               â”‚
â”‚    setEvents(events.map(e =>                            â”‚
â”‚      e.id === 123 ? updatedEvent : e                    â”‚
â”‚    ))                                                   â”‚
â”‚                                                          â”‚
â”‚ 2. Close form:                                          â”‚
â”‚    setEditingEvent(null)                                â”‚
â”‚    setActiveForm(null)                                  â”‚
â”‚                                                          â”‚
â”‚ 3. Calendar re-renders with updated event               â”‚
â”‚    - Event appears at new time (15:00 instead of 14:00)â”‚
â”‚    - Updated title and notes displayed                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Deleting an Event

### Flow: User Deletes Event via Context Menu
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ USER ACTION                                             â”‚
â”‚                                                          â”‚
â”‚ 1. User right-clicks event                             â”‚
â”‚ 2. Context menu: [Edit] [Delete] [Lock]                â”‚
â”‚ 3. User clicks "ğŸ—‘ï¸ Delete"                            â”‚
â”‚ 4. Confirmation dialog: "Delete this event?"            â”‚
â”‚ 5. User confirms                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP REQUEST                                            â”‚
â”‚                                                          â”‚
â”‚ DELETE /events/123                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ BACKEND (app.py)                                        â”‚
â”‚                                                          â”‚
â”‚ @app.route("/events/<int:event_id>", ["DELETE"])       â”‚
â”‚                                                          â”‚
â”‚ 1. Check if event exists:                               â”‚
â”‚    event = db.get_event_by_id(123)                      â”‚
â”‚    IF not found:                                        â”‚
â”‚      RETURN 404 Not Found                              â”‚
â”‚                                                          â”‚
â”‚ 2. Delete from database:                                â”‚
â”‚    success = db.delete_event(123)                       â”‚
â”‚                                                          â”‚
â”‚ 3. Return success response                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DATABASE (database.py)                                  â”‚
â”‚                                                          â”‚
â”‚ delete_event(event_id):                                 â”‚
â”‚                                                          â”‚
â”‚   DELETE FROM events                                    â”‚
â”‚   WHERE id = 123                                        â”‚
â”‚                                                          â”‚
â”‚   RETURN rows_affected > 0                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RESPONSE                                                â”‚
â”‚                                                          â”‚
â”‚ {                                                        â”‚
â”‚   "message": "Event deleted successfully"              â”‚
â”‚ }                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FRONTEND STATE UPDATE                                   â”‚
â”‚                                                          â”‚
â”‚ 1. Remove event from state:                             â”‚
â”‚    setEvents(events.filter(e => e.id !== 123))          â”‚
â”‚                                                          â”‚
â”‚ 2. Close context menu:                                  â”‚
â”‚    setContextMenu({visible: false})                     â”‚
â”‚                                                          â”‚
â”‚ 3. Calendar re-renders without deleted event            â”‚
â”‚                                                          â”‚
â”‚ 4. Show notification:                                   â”‚
â”‚    "âœ… Event deleted"                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Summary of Key Data Flows

### Data Flow Patterns

1. **Read Operations (GET)**
   - Frontend â†’ API Request â†’ Backend Route â†’ Database Query â†’ JSON Response â†’ Frontend State Update â†’ UI Render

2. **Create Operations (POST)**
   - User Input â†’ Form Validation â†’ API Request â†’ Backend Processing â†’ Conflict Checks â†’ Database Insert â†’ Response â†’ State Update â†’ UI Render

3. **Update Operations (PUT)**
   - User Modification â†’ Validation â†’ API Request â†’ Backend Validation â†’ Database Update â†’ Response â†’ State Merge â†’ UI Re-render

4. **Delete Operations (DELETE)**
   - User Action â†’ Confirmation â†’ API Request â†’ Backend Verification â†’ Database Delete â†’ Response â†’ State Filter â†’ UI Re-render

5. **Complex Operations (Scoring/Optimization)**
   - User Trigger â†’ API Request â†’ Backend Orchestration â†’ Multiple Calculations â†’ Algorithm Execution â†’ Comprehensive Response â†’ Rich UI Visualization

### State Management
- **Frontend State**: React useState hooks for events, preferences, forms, modals
- **Backend State**: Stateless (all state in database)
- **Database State**: SQLite persistent storage

### Real-time Updates
- No WebSockets (currently)
- UI updates immediately on successful API response
- FullCalendar automatically re-renders on state changes

### Error Handling Flow
```
Error Occurs â†’ Backend Catches â†’ HTTP Status Code â†’ Frontend Catches
â†’ User-Friendly Message â†’ Console Log (details) â†’ User Notified
```
